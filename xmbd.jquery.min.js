/*! jQuery xmbd - v0.1 - 2013-10-10
 * https://github.com/screeny05/xmbd
 * Copyright (c) 2013 Sebastian Langer
 * MIT-Licensed */
;(function(e){e.fn.xmbd=function(){var a=this;a.current={state:-1,provider:"",id:""};a.availableStates={"-1":"vUnstarted",0:"vEnded",1:"vPlaying",2:"vPaused",3:"vBuffering",5:"vCued",9:"playerReady"};a.guid=a.guid="xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)});var f={};a.on=function(a,c){f.hasOwnProperty(a)||(f[a]=[]);f[a].push(c)};a.trigger=function(a,c){f.hasOwnProperty(a)&&e(f[a]).each(function(a,b){b(c)})};a.provider= {youtube:{iframe:!1,getId:function(a){return(a=a.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i))?a[1]:!1},getUrl:function(b,c){c=c||{};var d=["?autoplay="+ +(c.autoplay||0),"autohide="+(c.autohide?"1":"2"),"loop="+(c.loop?"1&playlist="+b:"0"),"theme="+(c.theme||"dark"),"origin="+encodeURIComponent(window.location.protocol+"//"+window.location.host),"playerapiid="+a.guid,"enablejsapi=1&version=3&rel=0"].join("&");return"//www.youtube.com/v/"+ b+d},state:function(b){return a.availableStates.hasOwnProperty(b)?a.availableStates[b]:b},play:function(){a.player.playVideo()},pause:function(){a.player.pauseVideo()},stop:function(){a.player.stopVideo()},cue:function(b){a.player.seekTo(b,!0)}},vimeo:{iframe:!0,getId:function(a){return(a=a.match(/(?:player\.)?vimeo\.com\/(?:\w+\/)*(\d+)/i))?a[1]:!1},getUrl:function(b,c){c=c||{};var d=["?autoplay="+ +(c.autoplay||0),"byline="+ +(c.autohide||0),"portrait="+ +(c.autohide||0),"color="+(c.color||"00adef"), "loop="+ +(c.loop||0),"player_id="+a.guid,"api=1"].join("&");return"//player.vimeo.com/video/"+b+d},state:function(b){var c=a.availableStates;switch(b){case "finish":return c[0];case "play":return c[1];case "pause":return c[2];case "loadProgress":return c[3];case "seek":return c[5];case "ready":return c[9];default:return b}},post:function(b,c){c=c||!0;var d=e("#"+a.guid),f=window.location.protocol+d.attr("src").split("?")[0];d[0].contentWindow.postMessage(JSON.stringify({method:b,value:c}),f)},play:function(){a.provider.vimeo.post("play")}, pause:function(){a.provider.vimeo.post("pause")},stop:function(){a.provider.vimeo.post("unload")},cue:function(b){a.provider.vimeo.post("seekTo",b)}},dailymotion:{iframe:!1,getId:function(a){return(a=a.match(/dailymotion.com\/(?:(?:video|hub)\/([^_]+))?[^#]*(?:#video=([^_&]+))?/i))?a[2]?a[2]:a[1]:!1},getUrl:function(b,c){c=c||{};var d=["?autoPlay="+(c.autoplay||!1),!1===c.highlight?"":"highlight="+c.highlight,!1===c.foreground?"":"foreground="+c.foreground,!1===c.background?"":"background="+c.background, "playerapiid="+a.guid,"enableApi=1"].join("&");return"//www.dailymotion.com/swf/"+b+d},play:function(){a.player.playVideo()},pause:function(){a.player.pauseVideo()},stop:function(){a.player.stopVideo()},cue:function(b){a.player.seekTo(b)}}};a.getMediaUrl=function(b,c,d){if(!a.provider.hasOwnProperty(b))throw a.trigger("error","Provider not supported"),Error("Provider not supported");return{url:a.provider[b].getUrl(c,d),iframe:a.provider[b].iframe}};a.getMediaId=function(b){for(var c in a.provider)if(a.provider.hasOwnProperty(c)){var d= a.provider[c].getId(b);if(d)return{provider:c,id:d}}return!1};a.action=function(b){if(a.provider[a.current.provider].hasOwnProperty(b))return a.provider[a.current.provider][b].apply(this,Array.prototype.slice.call(arguments,1));if("toggle"===b)"vPlaying"!==a.current.state?a.action("play"):a.action("pause");else throw Error("No such method: "+b);};a.embed=function(b,c,d){"object"==typeof b&&"undefined"==typeof c&&"undefined"==typeof d&&(d=b,c=d.id,b=d.provider);if(d.hasOwnProperty("on"))for(var f in d.on)if(d.on.hasOwnProperty(f))a.on(f, d.on[f]);d=a.getMediaUrl(b,c,d);a.current.provider=b;a.current.id=c;0<e("#"+a.guid).length&&e("#"+a.guid).remove();a.player&&a.triggerStateChange(a.availableStates["-1"]);d.iframe?a.embedIframe(d.url):a.embedSWF(d.url)};a.embedIframe=function(b){a.append("<iframe src='"+b+"' id='"+a.guid+"' width='100%' height='100%' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>")};a.embedSWF=function(b){a.html("<div id='"+a.guid+"'></div>");swfobject.embedSWF(b,a.guid,"100%", "100%","8",null,null,{allowScriptAccess:"always",allowFullScreen:"true"},{id:a.guid},function(b){if(!b.success)throw a.trigger("error","Unable to embed SWF"),Error("Unable to embed SWF");})};a.triggerStateChange=function(b){a.trigger(b);a.trigger("playerStateChange",b);a.current.state=b};window["onytcstatechange_"+a.guid]=function(b){b=a.provider.youtube.state(b);a.triggerStateChange(b);"playerReady"==b&&(a.player=document.getElementById(a.guid))};window["onvimeostatechange_"+a.guid]=function(b){b= a.provider.vimeo.state(b);a.triggerStateChange(b);"playerReady"==b&&e(["pause","finish","play"]).each(function(b,d){a.provider.vimeo.post("addEventListener",d)})};return a}})(jQuery);window.ytCompatibleReady=function(e){var a=document.getElementById(e);a.addEventListener("onStateChange","onytcstatechange_"+e);a.addEventListener("onError","onytcstatechange_"+e);window["onytcstatechange_"+e](9)};window.onVimeoMessage=function(e){e=JSON.parse(e.data);window["onvimeostatechange_"+e.player_id](e.event)}; window.addEventListener?window.addEventListener("message",window.onVimeoMessage,!1):window.attachEvent("onmessage",window.onVimeoMessage,!1);window.onDailymotionPlayerReady=window.ytCompatibleReady;window.onYouTubePlayerReady=window.ytCompatibleReady;
