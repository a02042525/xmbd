/*! jQuery xmbd - v0.1 - 2013-10-10
 * https://github.com/screeny05/xmbd
 * Copyright (c) 2013 Sebastian Langer
 * MIT-Licensed */
;(function(e){e.fn.xmbd=function(){var a=this;a.current={state:-1,provider:"",id:""};a.guid=a.guid="xxxxxxxx_xxxx_4xxx_yxxx_xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=16*Math.random()|0;return("x"==a?c:c&3|8).toString(16)});var f={};a.on=function(a,c){f.hasOwnProperty(a)||(f[a]=[]);f[a].push(c)};a.trigger=function(a,c){f.hasOwnProperty(a)&&e(f[a]).each(function(a,b){b(c)})};a.provider={youtube:{iframe:!1,getId:function(a){return(a=a.match(/(?:youtube(?:-nocookie)?\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/ ]{11})/i))? a[1]:!1},getUrl:function(b,c){c=c||{};var d=["?autoplay="+ +(c.autoplay||0),"autohide="+(c.autohide?"1":"2"),"loop="+(c.loop?"1&playlist="+b:"0"),"theme="+(c.theme||"dark"),"origin="+encodeURIComponent(window.location.protocol+"//"+window.location.host),"playerapiid="+a.guid,"enablejsapi=1&version=3&rel=0"].join("&");return"//www.youtube.com/v/"+b+d},play:function(){a.player.playVideo()},pause:function(){a.player.pauseVideo()},stop:function(){a.player.stopVideo()},cue:function(b){a.player.seekTo(b, !0)},toggle:function(){1==a.current.state?a.action("pause"):a.action("play")}},vimeo:{iframe:!0,getId:function(a){return(a=a.match(/(?:player\.)?vimeo\.com\/(?:\w+\/)*(\d+)/i))?a[1]:!1},getUrl:function(b,c){var d=["?autoplay="+ +(c.autoplay||0),"byline="+ +(c.autohide||0),"portrait="+ +(c.autohide||0),"color="+(c.color||"00adef"),"loop="+ +(c.loop||0),"player_id="+a.guid,"api=1"].join("&");return"//player.vimeo.com/video/"+b+d},state:function(a){switch(a){case "finish":return 0;case "play":return 1; case "pause":return 2;case "loadProgress":return 3;case "seek":return 5;case "ready":return 9;default:return a}},post:function(b,c){c=c||!0;var d=e("#"+a.guid),f=window.location.protocol+d.attr("src").split("?")[0];d[0].contentWindow.postMessage(JSON.stringify({method:b,value:c}),f)},play:function(){a.provider.vimeo.post("play")},pause:function(){a.provider.vimeo.post("pause")},stop:function(){a.provider.vimeo.post("unload")},cue:function(b){a.provider.vimeo.post("seekTo",b)},toggle:function(){1== a.current.state?a.action("pause"):a.action("play")}},dailymotion:{iframe:!1,getId:function(a){return(a=a.match(/dailymotion.com\/(?:(?:video|hub)\/([^_]+))?[^#]*(?:#video=([^_&]+))?/i))?a[2]?a[2]:a[1]:!1},getUrl:function(b,c){var d=["?autoPlay="+(c.autoplay||!1),!1==c.highlight?"":"highlight="+c.highlight,!1==c.foreground?"":"foreground="+c.foreground,!1==c.background?"":"background="+c.background,"playerapiid="+a.guid,"enableApi=1"].join("&");return"//www.dailymotion.com/swf/"+b+d},play:function(){a.player.playVideo()}, pause:function(){a.player.pauseVideo()},stop:function(){a.player.stopVideo()},cue:function(b){a.player.seekTo(b)},toggle:function(){1==a.current.state?a.action("pause"):a.action("play")}}};a.getMediaUrl=function(b,c,d){if(!a.provider.hasOwnProperty(b))throw a.trigger("error","Provider not supported"),Error("Provider not supported");return{url:a.provider[b].getUrl(c,d),iframe:a.provider[b].iframe}};a.getMediaId=function(b){for(var c in a.provider)if(a.provider.hasOwnProperty(c)){var d=a.provider[c].getId(b); if(d)return{provider:c,id:d}}return!1};a.embed=function(b,c,d){"object"==typeof b&&"undefined"==typeof c&&"undefined"==typeof d&&(b.hasOwnProperty("options")&&(d=b.options),b.hasOwnProperty("on")&&(d.on=b.on),c=b.id,b=b.provider);d=d||{};if(d.hasOwnProperty("on"))for(var f in d.on)if(d.on.hasOwnProperty(f))a.on(f,d.on[f]);d=a.getMediaUrl(b,c,d);a.current.provider=b;a.current.id=c;0<e("#"+a.guid).length&&e("#"+a.guid).remove();a.player&&a.trigger("vUnstarted");d.iframe?a.embedIframe(d.url):a.embedSWF(d.url)}; a.embedIframe=function(b){a.append("<iframe src='"+b+"' id='"+a.guid+"' width='100%' height='100%' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>")};a.embedSWF=function(b){a.html("<div id='"+a.guid+"'></div>");swfobject.embedSWF(b,a.guid,"100%","100%","8",null,null,{allowScriptAccess:"always",allowFullScreen:"true"},{id:a.guid},function(c){if(!c.success)throw a.trigger("error","Unable to embed SWF"),Error("Unable to embed SWF");})};a.action=function(b){if(a.provider[a.current.provider].hasOwnProperty(b))return a.provider[a.current.provider][b].apply(this, Array.prototype.slice.call(arguments,1));throw Error("No such method: "+b);};a.triggerStateChange=function(b){var c=a.trigger;c("playerStateChange",b);a.current.state=b;switch(b){case -1:c("vUnstarted");break;case 0:c("vEnded");break;case 1:c("vPlaying");break;case 2:c("vPaused");break;case 3:c("vBuffering");break;case 5:c("vCued");break;case 9:c("playerReady");break;default:c("error",b)}};window["onytcstatechange_"+a.guid]=function(b){a.triggerStateChange(b);9==b&&(a.player=document.getElementById(a.guid))}; window["onvimeostatechange_"+a.guid]=function(b){b=a.provider.vimeo.state(b);a.triggerStateChange(b);9==b&&e(["pause","finish","play"]).each(function(c,b){a.provider.vimeo.post("addEventListener",b)})};return a}})(jQuery);window.ytCompatibleReady=function(e){var a=document.getElementById(e);a.addEventListener("onStateChange","onytcstatechange_"+e);a.addEventListener("onError","onytcstatechange_"+e);window["onytcstatechange_"+e](9)}; window.onVimeoMessage=function(e){e=JSON.parse(e.data);window["onvimeostatechange_"+e.player_id](e.event)};window.addEventListener?window.addEventListener("message",onVimeoMessage,!1):window.attachEvent("onmessage",onVimeoMessage,!1);window.onDailymotionPlayerReady=window.ytCompatibleReady;window.onYouTubePlayerReady=window.ytCompatibleReady;
